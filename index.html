<!DOCTYPE html>
<html>
<head>
    <title>ALF - I accept cats as payment</title>
    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    <style>
    html {
font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 14px;
  line-height: 1.428571429;
  color: #fff;
  color: rgba(255,255,255, 0.5);
  background-color: #fff;
  height: 100%;
  width: 100%;
}

.vert-text {
  display: table-cell;
  vertical-align: middle;
  text-align: center;
}

.vert-text h1 {
  padding: 0;
  margin: 0;
  font-size: 4.5em;
  font-weight: 700;
}

html {
  height: 100%;
  text-align: center;
}

body {
  height: 100%;
  text-align: center;
  opacity: 0.8;
  background: url(http://img2.wikia.nocookie.net/__cb20110128060130/alf/images/9/92/Cat_sandwich.jpg) no-repeat center center fixed; 
  -webkit-background-size: cover;
  -moz-background-size: cover;
  -o-background-size: cover;
  background-size: cover;
}

.header {
  display: table;
  width: 100%;
  position: relative;
  opacity: 0.8;
}

h1 {
  margin: .67em 0;
  font-size: 2em;
}

b,strong {
  font-weight: bold;
}

</style>
</head>
<body>
  <div class="header">
        <div class="vert-text">
            <h1><strong style="color:white">A</strong>rcGIS&nbsp;<strong style="color:white">L</strong>evel&nbsp;<strong style="color:white">F</strong>ixer</h1>
            <h2>
                <p><strong style="color:white">Speaking of cats, Where is the MapServer?</p> </h2>
                <input style="width:1000px; height:50px; font-size:20px; text-align: center" type="text" id="inputtext" placeholder="http://gismaps.vita.virginia.gov/arcgis/rest/services/MostRecentImagery/MostRecentImagery_WGS/MapServer">
        <br>
        <br>
        <input type="button" value="FEED ME"id="submit" style="width:125px; height:40px; font-size:20px; font-weight: bold;" ><img id="spinner" style="display:none" src="images/ajax-loader.gif"/>
        <br><br><br>
        <div id="response">
        </div>
        </div>
    </div>

    <script>
        function startLoading() {
            $("#submit").hide();
            $("#spinner").show();
        }
        function stopLoading() {
            $("#submit").show();
            $("#spinner").hide();
        }
        $("#inputtext").keyup(function(e){
            if(e.keyCode == 13)
            {
                $("#submit").click();
            }
        });
        $("#submit").click(function()
        {
            startLoading();
            var dataString = $("#inputtext").val();

            $.ajax({
                type: "GET",
                url: "http://arcgis-level-fixer.elasticbeanstalk.com/examine?url=" + dataString,
                success: function(result){
                    $("#response").html(result);
                    var html = "";

                    if(result.lods["0"] === 0) {
                        html += "<h2>That's a tasty cat!</h2><i>it should work as a basemap</i>";
                        return;
                    } else {
                        html += "<h2>Something's wrong with that cat... here's a new one:</h2>" + result.alf;
                    }

                    html += "<br><br>";

                    html += "<table style='margin: 0 auto; border: 1;'><tr><th>Original LOD</th><th>&nbsp;</th><th>OSM LOD</th></tr>";

                    for(var lodOSM in result.lods) {
                        html += "<tr><td>"+result.lods[lodOSM]+"</td><td>now maps to</td><td>"+lodOSM+"</td></tr>";
                    }

                    html += "</table>";

                    $("#response").html(html);
                    stopLoading();
                },
                error: function(result) {
                    $("#response").html("<b>This doesn't taste like a cat</b><br><br>it should look like this:<br><a href='http://gismaps.vita.virginia.gov/arcgis/rest/services/MostRecentImagery/MostRecentImagery_WGS/MapServer'>http://gismaps.vita.virginia.gov/arcgis/rest/services/MostRecentImagery/MostRecentImagery_WGS/MapServer</a>");
                    stopLoading();
                }
            });
        });
    </script>
    <a href="https://github.com/gisinc/arcgis-level-fixer"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://camo.githubusercontent.com/567c3a48d796e2fc06ea80409cc9dd82bf714434/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_left_darkblue_121621.png"></a>
</body>
</html>